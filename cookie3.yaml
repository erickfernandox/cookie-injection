id: cookie-injection-erickfernandox

info:
  name: Parameter based cookie injection
  author: pdteam
  severity: info
  reference:
    - https://www.invicti.com/blog/web-security/understanding-cookie-poisoning-attacks/
    - https://docs.imperva.com/bundle/on-premises-knowledgebase-reference-guide/page/cookie_injection.htm
  metadata:
    max-request: 1
  tags: reflected,dast,cookie,injection

http:
  - method: GET
    path:
      - "{{BaseURL}}/?promotion=cookie_injection;evil&useCase=cookie_injection;evil&album=cookie_injection;evil&addurl=cookie_injection;evil&locationType=cookie_injection;evil&viewAs=cookie_injection;evil&subsection=cookie_injection;evil&userLanguage=cookie_injection;evil&filePath=cookie_injection;evil&tracker=cookie_injection;evil&placement=cookie_injection;evil&authDomain=cookie_injection;evil&appURL=cookie_injection;evil&team=cookie_injection;evil"
      - "{{BaseURL}}/?client=cookie_injection;evil&filename=cookie_injection;evil&ext=cookie_injection;evil&external=cookie_injection;evil&utm_source=cookie_injection;evil&visibility=cookie_injection;evil&season=cookie_injection;evil&monitor=cookie_injection;evil&Itemid=cookie_injection;evil&promo=cookie_injection;evil&category=cookie_injection;evil&subscribe=cookie_injection;evil&unsubscribe=cookie_injection;evil&unsubscribe_token=cookie_injection;evil&event=cookie_injection;evil&local=cookie_injection;evil&brand=cookie_injection;evil&kind=cookie_injection;evil&department=cookie_injection;evil&product=cookie_injection;evil&product_id=cookie_injection;evil&productId=cookie_injection;evil&zipcode=cookie_injection;evil&day=cookie_injection;evil&phone=cookie_injection;evil&cc=cookie_injection;evil&command=cookie_injection;evil&token=XSS"  
      - "{{BaseURL}}/?querystring=cookie_injection;evil&charset=cookie_injection;evil&currency=cookie_injection;evil&device=cookie_injection;evil&browser=cookie_injection;evil&access_token=cookie_injection;evil&age=cookie_injection;evil&firstname=cookie_injection;evil&lastname=cookie_injection;evil&sobrenome=cookie_injection;evil&address=cookie_injection;evil&role=cookie_injection;evil&color=cookie_injection;evil&quantity=cookie_injection;evil&price=cookie_injection;evil&discount=cookie_injection;evil&rating=cookie_injection;evil&location=cookie_injection;evil&startDate=cookie_injection;evil&endDate=cookie_injection;evil&sessionID=cookie_injection;evil&oauthToken=cookie_injection;evil&errorURL=cookie_injection;evil&proxy=cookie_injection;evil&radius=cookie_injection;evil&callbackUrl=cookie_injection;evil&token=XSS"
      - "{{BaseURL}}/?languageCode=cookie_injection;evil&model=cookie_injection;evil&userAgent=cookie_injection;evil&utm_medium=cookie_injection;evil&utm_campaign=cookie_injection;evil&utm_content=cookie_injection;evil&trackingCode=cookie_injection;evil&session=cookie_injection;evil&timestamp=cookie_injection;evil&nonce=cookie_injection;evil&hash=cookie_injection;evil&grant_type=cookie_injection;evil&client_secret=cookie_injection;evil&realm=cookie_injection;evil&resource=cookie_injection;evil&preload=cookie_injection;evil&async=cookie_injection;evil&autoplay=cookie_injection;evil&control=cookie_injection;evil&controls=cookie_injection;evil&href=cookie_injection;evil&start=cookie_injection;evil&end=cookie_injection;evil&frameborder=cookie_injection;evil&referrer-policy=cookie_injection;evil&token=XSS"    
      - "{{BaseURL}}/?property=cookie_injection;evil&itemprop=cookie_injection;evil&datatype=cookie_injection;evil&about=cookie_injection;evil&typeof=cookie_injection;evil&hreflang=cookie_injection;evil&xmlns=cookie_injection;evil&placeholder=cookie_injection;evil&request_id=cookie_injection;evil&resource_url=cookie_injection;evil&contextType=cookie_injection;evil&challenge_url=cookie_injection;evil&linguagem=cookie_injection;evil&idCanal=cookie_injection;evil&channel=cookie_injection;evil&uf=cookie_injection;evil&target_id=cookie_injection;evil&manufacturer=cookie_injection;evil&t=cookie_injection;evil&scale=cookie_injection;evil&jsessionid=cookie_injection;evil&load=cookie_injection;evil&forward=cookie_injection;evil&userAction=cookie_injection;evil&ssoToken=cookie_injection;evil&SSO_token=cookie_injection;evil&token=XSS"     
      - "{{BaseURL}}/?securitytext=cookie_injection;evil&panel=cookie_injection;evil&subscrptionId=cookie_injection;evil&promocode=cookie_injection;evil&ordertype=cookie_injection;evil&reg=cookie_injection;evil&sms=cookie_injection;evil&user_in=cookie_injection;evil&item=cookie_injection;evil&license_number=cookie_injection;evil&originalurl=cookie_injection;evil&formid=cookie_injection;evil&reg_ip=cookie_injection;evil&thumbnail=cookie_injection;evil&arrival=cookie_injection;evil&meeting_id=cookie_injection;evil&internal=cookie_injection;evil&ColumnId=cookie_injection;evil&culture=cookie_injection;evil&cflang=cookie_injection;evil&filter_by=cookie_injection;evil&sourceid=cookie_injection;evil&sourceapp=cookie_injection;evil&pageurl=cookie_injection;evil&page_url=cookie_injection;evil&stream=cookie_injection;evil&token=XSS"      
      - "{{BaseURL}}/?ping=cookie_injection;evil&execution=cookie_injection;evil&location_id=cookie_injection;evil&RootFolder=cookie_injection;evil&root=cookie_injection;evil&click=cookie_injection;evil&ctag=cookie_injection;evil&messageid=cookie_injection;evil&message_id=cookie_injection;evil&queryinput=cookie_injection;evil&order_id=cookie_injection;evil&keyword=cookie_injection;evil&appId=cookie_injection;evil&api=cookie_injection;evil&releaseid=cookie_injection;evil&relay=cookie_injection;evil&root_id=cookie_injection;evil&unknown=cookie_injection;evil&auth_req=cookie_injection;evil&search_geolocation=cookie_injection;evil&params=cookie_injection;evil&persons=cookie_injection;evil&person=cookie_injection;evil&search_request=cookie_injection;evil&d=cookie_injection;evil&token=XSS"    
      - "{{BaseURL}}/?purchases=cookie_injection;evil&widget=cookie_injection;evil&targetUrl=cookie_injection;evil&public=cookie_injection;evil&requestUrl=cookie_injection;evil&redirect_back=cookie_injection;evil&ListId=cookie_injection;evil&module=cookie_injection;evil&PageNum=cookie_injection;evil&option=cookie_injection;evil&CustomerID=cookie_injection;evil&company_id=cookie_injection;evil&login_link=cookie_injection;evil&keys=cookie_injection;evil&paymentType=cookie_injection;evil&errorcode=cookie_injection;evil&courseCode=cookie_injection;evil&post_type=cookie_injection;evil&send_to=cookie_injection;evil&refid=cookie_injection;evil&vouchercode=cookie_injection;evil&os_destination=cookie_injection;evil&redirected-from=cookie_injection;evil&return_to_url=cookie_injection;evil&token=XSS"     
      - "{{BaseURL}}/?storeId=cookie_injection;evil&catalogId=cookie_injection;evil&langId=cookie_injection;evil&pageView=cookie_injection;evil&orderBy=cookie_injection;evil&homePageURL=cookie_injection;evil&absoluteURL=cookie_injection;evil&DirectoryPath=cookie_injection;evil&environment=cookie_injection;evil&shopUserId=cookie_injection;evil&agnt=cookie_injection;evil&pixel=cookie_injection;evil&partner=cookie_injection;evil&partner_id=cookie_injection;evil&cashback=cookie_injection;evil&lang_id=cookie_injection;evil&page_type=cookie_injection;evil&reg-type=cookie_injection;evil&account_name=cookie_injection;evil&market=cookie_injection;evil&site_id=cookie_injection;evil&campaignid=cookie_injection;evil&creative=cookie_injection;evil&matchtype=cookie_injection;evil&token=XSS" 
      - "{{BaseURL}}/?targetid=cookie_injection;evil&available=cookie_injection;evil&modules=cookie_injection;evil&reset=cookie_injection;evil&ids=cookie_injection;evil&userEmail=cookie_injection;evil&cm=cookie_injection;evil&friend=cookie_injection;evil&contract=cookie_injection;evil&online=cookie_injection;evil&route=cookie_injection;evil&routes=cookie_injection;evil&IP=cookie_injection;evil&trader=cookie_injection;evil&mobile=cookie_injection;evil&review_id=cookie_injection;evil&back_url=cookie_injection;evil&amount=cookie_injection;evil&filetype=cookie_injection;evil&search_type=cookie_injection;evil&step=cookie_injection;evil&order_by=cookie_injection;evil&feed=cookie_injection;evil&transaction_id=cookie_injection;evil&memory=cookie_injection;evil&ClientId=cookie_injection;evil&referralCode=cookie_injection;evil&token=XSS"          
      - "{{BaseURL}}/?operator_id=cookie_injection;evil&network=cookie_injection;evil&product_ids=cookie_injection;evil&csrf_token=cookie_injection;evil&menu_id=cookie_injection;evil&authuser=cookie_injection;evil&section=cookie_injection;evil&faq=cookie_injection;evil&rate=cookie_injection;evil&idsite=cookie_injection;evil&provider=cookie_injection;evil&id_category=cookie_injection;evil&official=cookie_injection;evil&identifier=cookie_injection;evil&check_in=cookie_injection;evil&view_by=cookie_injection;evil&componentID=cookie_injection;evil&validate_token=cookie_injection;evil&val=cookie_injection;evil&invoice=cookie_injection;evil&ticket=cookie_injection;evil&detail=cookie_injection;evil&curtype=cookie_injection;evil&action_type=cookie_injection;evil&uri_path=cookie_injection;evil&token=XSS"     
      - "{{BaseURL}}/?deadline=cookie_injection;evil&productKey=cookie_injection;evil&bundleId=cookie_injection;evil&searchid=cookie_injection;evil&tracking=cookie_injection;evil&cid=cookie_injection;evil&element_id=cookie_injection;evil&char=cookie_injection;evil&custom=cookie_injection;evil&act=cookie_injection;evil&agent=cookie_injection;evil&shop_id=cookie_injection;evil&otp_type=cookie_injection;evil&otp=cookie_injection;evil&fromUrl=cookie_injection;evil&count=cookie_injection;evil&policy=cookie_injection;evil&expire=cookie_injection;evil&mime_type=cookie_injection;evil&cd=cookie_injection;evil&flag=cookie_injection;evil&eventId=cookie_injection;evil&_=cookie_injection;evil&ssl=cookie_injection;evil&comments=cookie_injection;evil&pr-redirect=cookie_injection;evil&subcategories=cookie_injection;evil&token=XSS"           
      - "{{BaseURL}}/?collection=cookie_injection;evil&requirements=cookie_injection;evil&param=cookie_injection;evil&contest=cookie_injection;evil&photoId=cookie_injection;evil&fb_action_ids=cookie_injection;evil&highlight=cookie_injection;evil&join=cookie_injection;evil&membertype=cookie_injection;evil&active=cookie_injection;evil&subsection=cookie_injection;evil&release_id=cookie_injection;evil&sound=cookie_injection;evil&track=cookie_injection;evil"
      - "{{BaseURL}}/?embed=cookie_injection;evil&jumpTo=cookie_injection;evil&segment=cookie_injection;evil&dateRange=cookie_injection;evil&hex=cookie_injection;evil&base64=cookie_injection;evil&promoID=cookie_injection;evil&promo_id=cookie_injection;evil&eventType=cookie_injection;evil&audio=cookie_injection;evil&video=cookie_injection;evil&pageIndex=cookie_injection;evil&token=XSS"     

    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)(?i)(^set-cookie.*cookie_injection;evil.*)'
