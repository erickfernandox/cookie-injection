id: cookie-injection-erickfernandox

info:
  name: Parameter based cookie injection
  author: pdteam
  severity: info
  reference:
    - https://www.invicti.com/blog/web-security/understanding-cookie-poisoning-attacks/
    - https://docs.imperva.com/bundle/on-premises-knowledgebase-reference-guide/page/cookie_injection.htm
  metadata:
    max-request: 1
  tags: reflected,dast,cookie,injection

http:
  - method: GET
    path:
      - "{{BaseURL}}/?affiliateid=cookie_injection;evil&mediaId=cookie_injection;evil&skinPath=cookie_injection;evil&eos=cookie_injection;evil&promochild=cookie_injection;evil&utm_term=cookie_injection;evil&tpl=cookie_injection;evil&project_id=cookie_injection;evil&suggest=cookie_injection;evil&origem=cookie_injection;evil&proximo=cookie_injection;evil&referral_source=cookie_injection;evil&tag-id=cookie_injection;evil&imagem=cookie_injection;evil"
      - "{{BaseURL}}/?compare=cookie_injection;evil&demo=cookie_injection;evil&mod=cookie_injection;evil&free=cookie_injection;evil&abo_type=cookie_injection;evil&otag=cookie_injection;evil&privacy=cookie_injection;evil&pageId=cookie_injection;evil&incident_id=cookie_injection;evil&SuccessUrl=cookie_injection;evil&ad_group_id=cookie_injection;evil&accountNumber=cookie_injection;evil&policyNumber=cookie_injection;evil&agentId=cookie_injection;evil&traittype=cookie_injection;evil"
      - "{{BaseURL}}/?redirectTo=cookie_injection;evil&shortlink=cookie_injection;evil&start_page=cookie_injection;evil&filter-subtype=cookie_injection;evil&attr=cookie_injection;evil&bucket=cookie_injection;evil&ship_to=cookie_injection;evil&activity=cookie_injection;evil&trade=cookie_injection;evil&swap=cookie_injection;evil&markets=cookie_injection;evil&copytrading=cookie_injection;evil&recharge=cookie_injection;evil&red=cookie_injection;evil&expired=cookie_injection;evil"
      - "{{BaseURL}}/?chkout=cookie_injection;evil&proto=cookie_injection;evil&credential=cookie_injection;evil&credencial=cookie_injection;evil&scoped=cookie_injection;evil&utm_creative=cookie_injection;evil&search_terms=cookie_injection;evil&hunt=cookie_injection;evil&organization=cookie_injection;evil&back=cookie_injection;evil&notify=cookie_injection;evil&successRedirect=cookie_injection;evil&itm_data=cookie_injection;evil&webinar=cookie_injection;evil"
      - "{{BaseURL}}/?campID=cookie_injection;evil&agencyId=cookie_injection;evil&registration=cookie_injection;evil&SessionKey=cookie_injection;evil&seed=cookie_injection;evil&source_page=cookie_injection;evil&loc=987&imageId=cookie_injection;evil&jobid=cookie_injection;evil&policyholder=cookie_injection;evil&preview_id=cookie_injection;evil&dataURL=cookie_injection;evil&env=cookie_injection;evil&nobounce=cookie_injection;evil&serv=cookie_injection;evil&auth_uri=cookie_injection;evil"
      - "{{BaseURL}}/?EndCategory=cookie_injection;evil&_requestid=cookie_injection;evil&tab_name=cookie_injection;evil&custom-css=cookie_injection;evil&x-campaign=cookie_injection;evil&partNumber=cookie_injection;evil&referral=cookie_injection;evil&coupon=cookie_injection;evil&ref_type=cookie_injection;evil&%3c/script%3e%3cteste%3e1005&destinationAddress=cookie_injection;evil&traffic_src=cookie_injection;evil&sap-client=cookie_injection;evil&appwebview=cookie_injection;evil"
      - "{{BaseURL}}/?ticketReference=cookie_injection;evil&ByPath=cookie_injection;evil&lang_redirect=cookie_injection;evil&schedule=cookie_injection;evil&screen=cookie_injection;evil&exchange=cookie_injection;evil&asset_type=cookie_injection;evil&sc_channel=cookie_injection;evil&ssoType=cookie_injection;evil&colorName=cookie_injection;evil&details=cookie_injection;evil&_encoding=cookie_injection;evil&encoding=cookie_injection;evil&expand=cookie_injection;evil"
      - "{{BaseURL}}/?question=cookie_injection;evil&continue_to=cookie_injection;evil&diff=cookie_injection;evil&forgot=cookie_injection;evil&purpose=cookie_injection;evil&safe_search=cookie_injection;evil&languageid=cookie_injection;evil&offering_id=cookie_injection;evil&sysparm_query=cookie_injection;evil&suffix=cookie_injection;evil&organization_slug=cookie_injection;evil&merchant=cookie_injection;evil&viewkey=cookie_injection;evil&pkey=cookie_injection;evil"
      - "{{BaseURL}}/?agreed=cookie_injection;evil&EntityID=cookie_injection;evil&viewportId=cookie_injection;evil&resource_tag=cookie_injection;evil&propertyCode=cookie_injection;evil&ptype=cookie_injection;evil&modecode=cookie_injection;evil&evidence=cookie_injection;evil&contact-person=cookie_injection;evil&bundle_key=cookie_injection;evil&new_app=cookie_injection;evil&originUrl=cookie_injection;evil&ViewName=cookie_injection;evil&spaceID=cookie_injection;evil"      
      - "{{BaseURL}}/?AuthState=cookie_injection;evil&subjectCategory=cookie_injection;evil&score=cookie_injection;evil&achievement=cookie_injection;evil&tenantId=cookie_injection;evil&change_lang=cookie_injection;evil&agencyNumber=cookie_injection;evil&node=cookie_injection;evil&referral_path=cookie_injection;evil&files=cookie_injection;evil&mailTo=cookie_injection;evil&nick=cookie_injection;evil&sitename=cookie_injection;evil&mediaItemId=cookie_injection;evil"
      - "{{BaseURL}}/?gatewayID=cookie_injection;evil&filterAttributes=cookie_injection;evil&navPage=cookie_injection;evil&nextUrl=cookie_injection;evil&tagFilters=cookie_injection;evil&communityId=cookie_injection;evil&remote=cookie_injection;evil&securityId=cookie_injection;evil&UserToken=cookie_injection;evil&sysparam=cookie_injection;evil&topic=cookie_injection;evil&pgid=cookie_injection;evil&subtype=cookie_injection;evil&referrer_id=cookie_injection;evil&workspace=cookie_injection;evil"

    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)(?i)(^set-cookie.*cookie_injection;evil.*)'
