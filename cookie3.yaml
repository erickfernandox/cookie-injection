id: cookie-injection-erickfernandox

info:
  name: Parameter based cookie injection
  author: pdteam
  severity: info
  reference:
    - https://www.invicti.com/blog/web-security/understanding-cookie-poisoning-attacks/
    - https://docs.imperva.com/bundle/on-premises-knowledgebase-reference-guide/page/cookie_injection.htm
  metadata:
    max-request: 1
  tags: reflected,dast,cookie,injection

http:
  - method: GET
    path:
      - "{{BaseURL}}/?promotion=cookie_injection&useCase=cookie_injection&album=cookie_injection&addurl=cookie_injection&locationType=cookie_injection&viewAs=cookie_injection&subsection=cookie_injection&userLanguage=cookie_injection&filePath=cookie_injection&tracker=cookie_injection&placement=cookie_injection&authDomain=cookie_injection&appURL=cookie_injection&team=cookie_injection"
      - "{{BaseURL}}/?client=cookie_injection&filename=cookie_injection&ext=cookie_injection&external=cookie_injection&utm_source=cookie_injection&visibility=cookie_injection&season=cookie_injection&monitor=cookie_injection&Itemid=cookie_injection&promo=cookie_injection&category=cookie_injection&subscribe=cookie_injection&unsubscribe=cookie_injection&unsubscribe_token=cookie_injection&event=cookie_injection&local=cookie_injection&brand=cookie_injection&kind=cookie_injection&department=cookie_injection&product=cookie_injection&product_id=cookie_injection&productId=cookie_injection&zipcode=cookie_injection&day=cookie_injection&phone=cookie_injection&cc=cookie_injection&command=cookie_injection&token=XSS"  
      - "{{BaseURL}}/?querystring=cookie_injection&charset=cookie_injection&currency=cookie_injection&device=cookie_injection&browser=cookie_injection&access_token=cookie_injection&age=cookie_injection&firstname=cookie_injection&lastname=cookie_injection&sobrenome=cookie_injection&address=cookie_injection&role=cookie_injection&color=cookie_injection&quantity=cookie_injection&price=cookie_injection&discount=cookie_injection&rating=cookie_injection&location=cookie_injection&startDate=cookie_injection&endDate=cookie_injection&sessionID=cookie_injection&oauthToken=cookie_injection&errorURL=cookie_injection&proxy=cookie_injection&radius=cookie_injection&callbackUrl=cookie_injection&token=XSS"
      - "{{BaseURL}}/?languageCode=cookie_injection&model=cookie_injection&userAgent=cookie_injection&utm_medium=cookie_injection&utm_campaign=cookie_injection&utm_content=cookie_injection&trackingCode=cookie_injection&session=cookie_injection&timestamp=cookie_injection&nonce=cookie_injection&hash=cookie_injection&grant_type=cookie_injection&client_secret=cookie_injection&realm=cookie_injection&resource=cookie_injection&preload=cookie_injection&async=cookie_injection&autoplay=cookie_injection&control=cookie_injection&controls=cookie_injection&href=cookie_injection&start=cookie_injection&end=cookie_injection&frameborder=cookie_injection&referrer-policy=cookie_injection&token=XSS"    
      - "{{BaseURL}}/?property=cookie_injection&itemprop=cookie_injection&datatype=cookie_injection&about=cookie_injection&typeof=cookie_injection&hreflang=cookie_injection&xmlns=cookie_injection&placeholder=cookie_injection&request_id=cookie_injection&resource_url=cookie_injection&contextType=cookie_injection&challenge_url=cookie_injection&linguagem=cookie_injection&idCanal=cookie_injection&channel=cookie_injection&uf=cookie_injection&target_id=cookie_injection&manufacturer=cookie_injection&t=cookie_injection&scale=cookie_injection&jsessionid=cookie_injection&load=cookie_injection&forward=cookie_injection&userAction=cookie_injection&ssoToken=cookie_injection&SSO_token=cookie_injection&token=XSS"     
      - "{{BaseURL}}/?securitytext=cookie_injection&panel=cookie_injection&subscrptionId=cookie_injection&promocode=cookie_injection&ordertype=cookie_injection&reg=cookie_injection&sms=cookie_injection&user_in=cookie_injection&item=cookie_injection&license_number=cookie_injection&originalurl=cookie_injection&formid=cookie_injection&reg_ip=cookie_injection&thumbnail=cookie_injection&arrival=cookie_injection&meeting_id=cookie_injection&internal=cookie_injection&ColumnId=cookie_injection&culture=cookie_injection&cflang=cookie_injection&filter_by=cookie_injection&sourceid=cookie_injection&sourceapp=cookie_injection&pageurl=cookie_injection&page_url=cookie_injection&stream=cookie_injection&token=XSS"      
      - "{{BaseURL}}/?ping=cookie_injection&execution=cookie_injection&location_id=cookie_injection&RootFolder=cookie_injection&root=cookie_injection&click=cookie_injection&ctag=cookie_injection&messageid=cookie_injection&message_id=cookie_injection&queryinput=cookie_injection&order_id=cookie_injection&keyword=cookie_injection&appId=cookie_injection&api=cookie_injection&releaseid=cookie_injection&relay=cookie_injection&root_id=cookie_injection&unknown=cookie_injection&auth_req=cookie_injection&search_geolocation=cookie_injection&params=cookie_injection&persons=cookie_injection&person=cookie_injection&search_request=cookie_injection&d=cookie_injection&token=XSS"    
      - "{{BaseURL}}/?purchases=cookie_injection&widget=cookie_injection&targetUrl=cookie_injection&public=cookie_injection&requestUrl=cookie_injection&redirect_back=cookie_injection&ListId=cookie_injection&module=cookie_injection&PageNum=cookie_injection&option=cookie_injection&CustomerID=cookie_injection&company_id=cookie_injection&login_link=cookie_injection&keys=cookie_injection&paymentType=cookie_injection&errorcode=cookie_injection&courseCode=cookie_injection&post_type=cookie_injection&send_to=cookie_injection&refid=cookie_injection&vouchercode=cookie_injection&os_destination=cookie_injection&redirected-from=cookie_injection&return_to_url=cookie_injection&token=XSS"     
      - "{{BaseURL}}/?storeId=cookie_injection&catalogId=cookie_injection&langId=cookie_injection&pageView=cookie_injection&orderBy=cookie_injection&homePageURL=cookie_injection&absoluteURL=cookie_injection&DirectoryPath=cookie_injection&environment=cookie_injection&shopUserId=cookie_injection&agnt=cookie_injection&pixel=cookie_injection&partner=cookie_injection&partner_id=cookie_injection&cashback=cookie_injection&lang_id=cookie_injection&page_type=cookie_injection&reg-type=cookie_injection&account_name=cookie_injection&market=cookie_injection&site_id=cookie_injection&campaignid=cookie_injection&creative=cookie_injection&matchtype=cookie_injection&token=XSS" 
      - "{{BaseURL}}/?targetid=cookie_injection&available=cookie_injection&modules=cookie_injection&reset=cookie_injection&ids=cookie_injection&userEmail=cookie_injection&cm=cookie_injection&friend=cookie_injection&contract=cookie_injection&online=cookie_injection&route=cookie_injection&routes=cookie_injection&IP=cookie_injection&trader=cookie_injection&mobile=cookie_injection&review_id=cookie_injection&back_url=cookie_injection&amount=cookie_injection&filetype=cookie_injection&search_type=cookie_injection&step=cookie_injection&order_by=cookie_injection&feed=cookie_injection&transaction_id=cookie_injection&memory=cookie_injection&ClientId=cookie_injection&referralCode=cookie_injection&token=XSS"          
      - "{{BaseURL}}/?operator_id=cookie_injection&network=cookie_injection&product_ids=cookie_injection&csrf_token=cookie_injection&menu_id=cookie_injection&authuser=cookie_injection&section=cookie_injection&faq=cookie_injection&rate=cookie_injection&idsite=cookie_injection&provider=cookie_injection&id_category=cookie_injection&official=cookie_injection&identifier=cookie_injection&check_in=cookie_injection&view_by=cookie_injection&componentID=cookie_injection&validate_token=cookie_injection&val=cookie_injection&invoice=cookie_injection&ticket=cookie_injection&detail=cookie_injection&curtype=cookie_injection&action_type=cookie_injection&uri_path=cookie_injection&token=XSS"     
      - "{{BaseURL}}/?deadline=cookie_injection&productKey=cookie_injection&bundleId=cookie_injection&searchid=cookie_injection&tracking=cookie_injection&cid=cookie_injection&element_id=cookie_injection&char=cookie_injection&custom=cookie_injection&act=cookie_injection&agent=cookie_injection&shop_id=cookie_injection&otp_type=cookie_injection&otp=cookie_injection&fromUrl=cookie_injection&count=cookie_injection&policy=cookie_injection&expire=cookie_injection&mime_type=cookie_injection&cd=cookie_injection&flag=cookie_injection&eventId=cookie_injection&_=cookie_injection&ssl=cookie_injection&comments=cookie_injection&pr-redirect=cookie_injection&subcategories=cookie_injection&token=XSS"           
      - "{{BaseURL}}/?collection=cookie_injection&requirements=cookie_injection&param=cookie_injection&contest=cookie_injection&photoId=cookie_injection&fb_action_ids=cookie_injection&highlight=cookie_injection&join=cookie_injection&membertype=cookie_injection&active=cookie_injection&subsection=cookie_injection&release_id=cookie_injection&sound=cookie_injection&track=cookie_injection"
      - "{{BaseURL}}/?embed=cookie_injection&jumpTo=cookie_injection&segment=cookie_injection&dateRange=cookie_injection&hex=cookie_injection&base64=cookie_injection&promoID=cookie_injection&promo_id=cookie_injection&eventType=cookie_injection&audio=cookie_injection&video=cookie_injection&pageIndex=cookie_injection&token=XSS"     

    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)(?i)(^set-cookie.*cookie_injection.*)'
