id: cookie-injection-erickfernandox

info:
  name: Parameter based cookie injection
  author: pdteam
  severity: info
  reference:
    - https://www.invicti.com/blog/web-security/understanding-cookie-poisoning-attacks/
    - https://docs.imperva.com/bundle/on-premises-knowledgebase-reference-guide/page/cookie_injection.htm
  metadata:
    max-request: 1
  tags: reflected,dast,cookie,injection

http:
  - method: GET
    path:
      - "{{BaseURL}}/?qs=cookie_injection;evil&search=cookie_injection;evil&query=cookie_injection;evil&keywords=cookie_injection;evil&term=cookie_injection;evil&text=cookie_injection;evil&input=cookie_injection;evil&value=cookie_injection;evil&username=cookie_injection;evil&password=cookie_injection;evil&name=cookie_injection;evil&email=cookie_injection;evil&comment=cookie_injection;evil&message=cookie_injection;evil&body=cookie_injection;evil&title=cookie_injection;evil&subject=cookie_injection;evil&description=cookie_injection;evil"
      - "{{BaseURL}}/?content=cookie_injection;evil&id=cookie_injection;evil&user=cookie_injection;evil&uid=cookie_injection;evil&redirect_url=cookie_injection;evil&return=cookie_injection;evil&url=https://%3c/script%3e%3cteste%3e25&titulo=cookie_injection;evil&link=cookie_injection;evil&goto=cookie_injection;evil&page=cookie_injection;evil&redir=cookie_injection;evil&redirect=cookie_injection;evil&redirect_to=cookie_injection;evil&token=XSS&next=cookie_injection;evil&callback=cookie_injection;evil&referrer=cookie_injection;evil"
      - "{{BaseURL}}/?referer=cookie_injection;evil&target=cookie_injection;evil&destination=cookie_injection;evil&returnUrl=cookie_injection;evil&return_uri=cookie_injection;evil&return_path=cookie_injection;evil&returnto=cookie_injection;evil&return_to=cookie_injection;evil&msg=cookie_injection;evil&error=cookie_injection;evil&date=cookie_injection;evil&token=cookie_injection;evil&sort=cookie_injection;evil&lang=cookie_injection;evil&file=cookie_injection;evil&type=cookie_injection;evil&next_url=cookie_injection;evil"
      - "{{BaseURL}}/?continue=cookie_injection;evil&dest=cookie_injection;evil&destination_uri=cookie_injection;evil&destination_url=cookie_injection;evil&go=cookie_injection;evil&to=cookie_injection;evil&view=cookie_injection;evil&sc=cookie_injection;evil&path=cookie_injection;evil&token=XSS&prod=cookie_injection;evil&main=cookie_injection;evil&data=cookie_injection;evil&action=cookie_injection;evil&busca=cookie_injection;evil&tag=cookie_injection;evil&show=cookie_injection;evil"
      - "{{BaseURL}}/?cpf=cookie_injection;evil&js=cookie_injection;evil&css=cookie_injection;evil&xml=cookie_injection;evil&cmd=cookie_injection;evil&key=cookie_injection;evil&secret=cookie_injection;evil&height=cookie_injection;evil&with=cookie_injection;evil&source=cookie_injection;evil&auth=cookie_injection;evil&author=cookie_injection;evil&login=cookie_injection;evil&logout=cookie_injection;evil&iframe=cookie_injection;evil&offset=cookie_injection;evil&app=cookie_injection;evil&home=cookie_injection;evil&post=cookie_injection;evil&format=cookie_injection;evil"
      - "{{BaseURL}}/?image=cookie_injection;evil&script=cookie_injection;evil&cod=cookie_injection;evil&code=cookie_injection;evil&time=cookie_injection;evil&new=cookie_injection;evil&download=cookie_injection;evil&ref=cookie_injection;evil&category_id=cookie_injection;evil&token=XSS&ads=cookie_injection;evil&img=cookie_injection;evil&gclid=cookie_injection;evil&plan=cookie_injection;evil&conta=cookie_injection;evil&_id=cookie_injection;evilmgs=cookie_injection;evil"
      - "{{BaseURL}}/?price=cookie_injection;evil&v=cookie_injection;evil&pag=cookie_injection;evil&feed=cookie_injection;evil&n=cookie_injection;evil&ids=cookie_injection;evil&origem=cookie_injection;evil&group=cookie_injection;evil&cat=cookie_injection;evil&preview=cookie_injection;evil&nome=cookie_injection;evil&from=cookie_injection;evil&fileId=cookie_injection;evil&err=cookie_injection;evil&page_id=cookie_injection;evil&region=cookie_injection;evil&order=cookie_injection;evil&id_url=cookie_injection;evil&nav=cookie_injection;evil"
      - "{{BaseURL}}/?by=cookie_injection;evil&pg=cookie_injection;evil&admin=cookie_injection;evil&api_key=cookie_injection;evil&configUrl=cookie_injection;evil&baseUrl=cookie_injection;evil&shortUrl=cookie_injection;evil&token=XSS&mode=cookie_injection;evil&foto=cookie_injection;evil&photo=cookie_injection;evil&msisdn=cookie_injection;evil&pagid=cookie_injection;evil&country=cookie_injection;evil&city=cookie_injection;evil&state=cookie_injection;evil&recommendationId=cookie_injection;evil"
      - "{{BaseURL}}/?limit=cookie_injection;evil&profile=cookie_injection;evil&signature=cookie_injection;evil&stage=cookie_injection;evil&share=cookie_injection;evil&accessCode=cookie_injection;evil&gid=cookie_injection;evil&galerie=cookie_injection;evil&include=cookie_injection;evil&source=cookie_injection;evil&filter=cookie_injection;evil&data_url=cookie_injection;evil&cookie=cookie_injection;evil&videoId=cookie_injection;evil&slug=cookie_injection;evil&resize=cookie_injection;evil&w=cookie_injection;evil&h=cookie_injection;evil&nextPage=cookie_injection;evil&tab=cookie_injection;evil&token=XSS"
      - "{{BaseURL}}/?size=cookie_injection;evil&cache=cookie_injection;evil&APIKey=cookie_injection;evil&random=cookie_injection;evil&alt=cookie_injection;evil&teamid=cookie_injection;evil&folder=cookie_injection;evil&registrationId=cookie_injection;evil&src=cookie_injection;evil&courseId=cookie_injection;evil&rebuild=cookie_injection;evil&r=cookie_injection;evil&endpoint=cookie_injection;evil&siteID=cookie_injection;evil&year=cookie_injection;evil&typeId=cookie_injection;evil&idpartner=cookie_injection;evil"
      - "{{BaseURL}}/?receiver=cookie_injection;evil&level=cookie_injection;evil&fbclid=cookie_injection;evil&values=cookie_injection;evil&onSuccess=cookie_injection;evil&theme=cookie_injection;evil&user_id=cookie_injection;evil&userId=cookie_injection;evil&template=cookie_injection;evil&version=cookie_injection;evil&select=cookie_injection;evil&token=XSS&changeTo=cookie_injection;evil&os=cookie_injection;evil&ver=cookie_injection;evil&SAMLRequest=cookie_injection;evil&uuid=cookie_injection;evil&config=cookie_injection;evil"
      - "{{BaseURL}}/?linkId=cookie_injection;evil&client_id=cookie_injection;evil&locale=cookie_injection;evil&view_type=cookie_injection;evil&qualify=cookie_injection;evil&googleID=cookie_injection;evil&campaign=cookie_injection;evil&status=cookie_injection;evil&service=cookie_injection;evil&class=cookie_injection;evil&crop=cookie_injection;evil&application=cookie_injection;evil&uri=cookie_injection;evil&report=cookie_injection;evil&event_name=cookie_injection;evil&debug=cookie_injection;evil&tipo=cookie_injection;evil"
      - "{{BaseURL}}/?strData=cookie_injection;evil&pagina=cookie_injection;evil&idHome=cookie_injection;evil&sleep=cookie_injection;evil&account=cookie_injection;evil&token=XSS&prefix=cookie_injection;evil&oauth=cookie_injection;evil&mail=cookie_injection;evil&index=cookie_injection;evil&authorize=cookie_injection;evil&tokenID=cookie_injection;evil&scope=cookie_injection;evil&response_type=cookie_injection;evil"
      - "{{BaseURL}}/?onclick=cookie_injection;evil&form=cookie_injection;evil&position=cookie_injection;evil&json=cookie_injection;evil&jsonp=cookie_injection;evil&cron=cookie_injection;evil&account_id=cookie_injection;evil&accountID=cookie_injection;evil&display=cookie_injection;evil&_csrf=cookie_injection;evil&csrf=cookie_injection;evil&signup=cookie_injection;evil&signout=cookie_injection;evil&logoff=cookie_injection;evil&public=cookie_injection;evil&footer=cookie_injection;evil&header=cookie_injection;evil&contact=cookie_injection;evil&setup=cookie_injection;evil&migration=cookie_injection;evil&token=XSS"      
      - "{{BaseURL}}/?features=cookie_injection;evil&feature=cookie_injection;evil&chains=cookie_injection;evil&chain=cookie_injection;evil&info=cookie_injection;evil&into=cookie_injection;evil&app_id=cookie_injection;evil&release=cookie_injection;evil&request=cookie_injection;evil&alert=cookie_injection;evil&notice=cookie_injection;evil&notification=cookie_injection;evil&warning=cookie_injection;evil&success=cookie_injection;evil&feedback=cookie_injection;evil&prompt=cookie_injection;evil&modal=cookie_injection;evil&popup=cookie_injection;evil&pop=cookie_injection;evil&toast=cookie_injection;evil&banner=cookie_injection;evil&announcement=cookie_injection;evil&note=cookie_injection;evil&hint=cookie_injection;evil&confirmation=cookie_injection;evil&result=cookie_injection;evil&update=cookie_injection;evil&response=cookie_injection;evil&token=XSS"
      - "{{BaseURL}}/?dialog=cookie_injection;evil&box=cookie_injection;evil&commentary=cookie_injection;evil&statement=cookie_injection;evil&commentary=cookie_injection;evil&explanation=cookie_injection;evil&guideline=cookie_injection;evil&tip=cookie_injection;evil&instruction=cookie_injection;evil&pointer=cookie_injection;evil&suggestion=cookie_injection;evil&direction=cookie_injection;evil&advisory=cookie_injection;evil&remark=cookie_injection;evil&notation=cookie_injection;evil&output=cookie_injection;evil&outcome=cookie_injection;evil&reflection=cookie_injection;evil&label=cookie_injection;evil&mensagem=cookie_injection;evil&texto=cookie_injection;evil&conteudo=cookie_injection;evil&payload=cookie_injection;evil&aviso=cookie_injection;evil&alerta=cookie_injection;evil&notificacao=cookie_injection;evil&token=XSS"
      - "{{BaseURL}}/?instrucao=cookie_injection;evil&comunicado=cookie_injection;evilerromsg=cookie_injection;evil&sucesso=cookie_injection;evil&btn=cookie_injection;evil&button=cookie_injection;evil&leight=cookie_injection;evil&host=cookie_injection;evil&domain=cookie_injection;evil&http=cookie_injection;evil&subdomain=cookie_injection;evil&server=cookie_injection;evil&origin=cookie_injection;evil&ip=cookie_injection;evil&protocol=cookie_injection;evil&gateway=cookie_injection;evil&site=cookie_injection;evil&platform=cookie_injection;evil&language=cookie_injection;evil&encode=cookie_injection;evil&scheme=cookie_injection;evil&consulta=cookie_injection;evil&submit=cookie_injection;evil&method=cookie_injection;evil&data-id=cookie_injection;evil&authType=cookie_injection;evil&isRegister=cookie_injection;evil&loginRequestId=cookie_injection;evil&token=XSS"      

    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)(?i)(^set-cookie.*cookie_injection;evil.*)'
