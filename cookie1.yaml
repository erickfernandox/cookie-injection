id: cookie-injection-erickfernandox

info:
  name: Parameter based cookie injection
  author: pdteam
  severity: info
  reference:
    - https://www.invicti.com/blog/web-security/understanding-cookie-poisoning-attacks/
    - https://docs.imperva.com/bundle/on-premises-knowledgebase-reference-guide/page/cookie_injection.htm
  metadata:
    max-request: 1
  tags: reflected,dast,cookie,injection

http:
  - method: GET
    path:
      - "{{BaseURL}}/?qs=cookie_injection&search=cookie_injection&query=cookie_injection&keywords=cookie_injection&term=cookie_injection&text=cookie_injection&input=cookie_injection&value=cookie_injection&username=cookie_injection&password=cookie_injection&name=cookie_injection&email=cookie_injection&comment=cookie_injection&message=cookie_injection&body=cookie_injection&title=cookie_injection&subject=cookie_injection&description=cookie_injection"
      - "{{BaseURL}}/?content=cookie_injection&id=cookie_injection&user=cookie_injection&uid=cookie_injection&redirect_url=cookie_injection&return=cookie_injection&url=https://%3c/script%3e%3cteste%3e25&titulo=cookie_injection&link=cookie_injection&goto=cookie_injection&page=cookie_injection&redir=cookie_injection&redirect=cookie_injection&redirect_to=cookie_injection&token=XSS&next=cookie_injection&callback=cookie_injection&referrer=cookie_injection"
      - "{{BaseURL}}/?referer=cookie_injection&target=cookie_injection&destination=cookie_injection&returnUrl=cookie_injection&return_uri=cookie_injection&return_path=cookie_injection&returnto=cookie_injection&return_to=cookie_injection&msg=cookie_injection&error=cookie_injection&date=cookie_injection&token=cookie_injection&sort=cookie_injection&lang=cookie_injection&file=cookie_injection&type=cookie_injection&next_url=cookie_injection"
      - "{{BaseURL}}/?continue=cookie_injection&dest=cookie_injection&destination_uri=cookie_injection&destination_url=cookie_injection&go=cookie_injection&to=cookie_injection&view=cookie_injection&sc=cookie_injection&path=cookie_injection&token=XSS&prod=cookie_injection&main=cookie_injection&data=cookie_injection&action=cookie_injection&busca=cookie_injection&tag=cookie_injection&show=cookie_injection"
      - "{{BaseURL}}/?cpf=cookie_injection&js=cookie_injection&css=cookie_injection&xml=cookie_injection&cmd=cookie_injection&key=cookie_injection&secret=cookie_injection&height=cookie_injection&with=cookie_injection&source=cookie_injection&auth=cookie_injection&author=cookie_injection&login=cookie_injection&logout=cookie_injection&iframe=cookie_injection&offset=cookie_injection&app=cookie_injection&home=cookie_injection&post=cookie_injection&format=cookie_injection"
      - "{{BaseURL}}/?image=cookie_injection&script=cookie_injection&cod=cookie_injection&code=cookie_injection&time=cookie_injection&new=cookie_injection&download=cookie_injection&ref=cookie_injection&category_id=cookie_injection&token=XSS&ads=cookie_injection&img=cookie_injection&gclid=cookie_injection&plan=cookie_injection&conta=cookie_injection&_id=cookie_injectionmgs=cookie_injection"
      - "{{BaseURL}}/?price=cookie_injection&v=cookie_injection&pag=cookie_injection&feed=cookie_injection&n=cookie_injection&ids=cookie_injection&origem=cookie_injection&group=cookie_injection&cat=cookie_injection&preview=cookie_injection&nome=cookie_injection&from=cookie_injection&fileId=cookie_injection&err=cookie_injection&page_id=cookie_injection&region=cookie_injection&order=cookie_injection&id_url=cookie_injection&nav=cookie_injection"
      - "{{BaseURL}}/?by=cookie_injection&pg=cookie_injection&admin=cookie_injection&api_key=cookie_injection&configUrl=cookie_injection&baseUrl=cookie_injection&shortUrl=cookie_injection&token=XSS&mode=cookie_injection&foto=cookie_injection&photo=cookie_injection&msisdn=cookie_injection&pagid=cookie_injection&country=cookie_injection&city=cookie_injection&state=cookie_injection&recommendationId=cookie_injection"
      - "{{BaseURL}}/?limit=cookie_injection&profile=cookie_injection&signature=cookie_injection&stage=cookie_injection&share=cookie_injection&accessCode=cookie_injection&gid=cookie_injection&galerie=cookie_injection&include=cookie_injection&source=cookie_injection&filter=cookie_injection&data_url=cookie_injection&cookie=cookie_injection&videoId=cookie_injection&slug=cookie_injection&resize=cookie_injection&w=cookie_injection&h=cookie_injection&nextPage=cookie_injection&tab=cookie_injection&token=XSS"
      - "{{BaseURL}}/?size=cookie_injection&cache=cookie_injection&APIKey=cookie_injection&random=cookie_injection&alt=cookie_injection&teamid=cookie_injection&folder=cookie_injection&registrationId=cookie_injection&src=cookie_injection&courseId=cookie_injection&rebuild=cookie_injection&r=cookie_injection&endpoint=cookie_injection&siteID=cookie_injection&year=cookie_injection&typeId=cookie_injection&idpartner=cookie_injection"
      - "{{BaseURL}}/?receiver=cookie_injection&level=cookie_injection&fbclid=cookie_injection&values=cookie_injection&onSuccess=cookie_injection&theme=cookie_injection&user_id=cookie_injection&userId=cookie_injection&template=cookie_injection&version=cookie_injection&select=cookie_injection&token=XSS&changeTo=cookie_injection&os=cookie_injection&ver=cookie_injection&SAMLRequest=cookie_injection&uuid=cookie_injection&config=cookie_injection"
      - "{{BaseURL}}/?linkId=cookie_injection&client_id=cookie_injection&locale=cookie_injection&view_type=cookie_injection&qualify=cookie_injection&googleID=cookie_injection&campaign=cookie_injection&status=cookie_injection&service=cookie_injection&class=cookie_injection&crop=cookie_injection&application=cookie_injection&uri=cookie_injection&report=cookie_injection&event_name=cookie_injection&debug=cookie_injection&tipo=cookie_injection"
      - "{{BaseURL}}/?strData=cookie_injection&pagina=cookie_injection&idHome=cookie_injection&sleep=cookie_injection&account=cookie_injection&token=XSS&prefix=cookie_injection&oauth=cookie_injection&mail=cookie_injection&index=cookie_injection&authorize=cookie_injection&tokenID=cookie_injection&scope=cookie_injection&response_type=cookie_injection"
      - "{{BaseURL}}/?onclick=cookie_injection&form=cookie_injection&position=cookie_injection&json=cookie_injection&jsonp=cookie_injection&cron=cookie_injection&account_id=cookie_injection&accountID=cookie_injection&display=cookie_injection&_csrf=cookie_injection&csrf=cookie_injection&signup=cookie_injection&signout=cookie_injection&logoff=cookie_injection&public=cookie_injection&footer=cookie_injection&header=cookie_injection&contact=cookie_injection&setup=cookie_injection&migration=cookie_injection&token=XSS"      
      - "{{BaseURL}}/?features=cookie_injection&feature=cookie_injection&chains=cookie_injection&chain=cookie_injection&info=cookie_injection&into=cookie_injection&app_id=cookie_injection&release=cookie_injection&request=cookie_injection&alert=cookie_injection&notice=cookie_injection&notification=cookie_injection&warning=cookie_injection&success=cookie_injection&feedback=cookie_injection&prompt=cookie_injection&modal=cookie_injection&popup=cookie_injection&pop=cookie_injection&toast=cookie_injection&banner=cookie_injection&announcement=cookie_injection&note=cookie_injection&hint=cookie_injection&confirmation=cookie_injection&result=cookie_injection&update=cookie_injection&response=cookie_injection&token=XSS"
      - "{{BaseURL}}/?dialog=cookie_injection&box=cookie_injection&commentary=cookie_injection&statement=cookie_injection&commentary=cookie_injection&explanation=cookie_injection&guideline=cookie_injection&tip=cookie_injection&instruction=cookie_injection&pointer=cookie_injection&suggestion=cookie_injection&direction=cookie_injection&advisory=cookie_injection&remark=cookie_injection&notation=cookie_injection&output=cookie_injection&outcome=cookie_injection&reflection=cookie_injection&label=cookie_injection&mensagem=cookie_injection&texto=cookie_injection&conteudo=cookie_injection&payload=cookie_injection&aviso=cookie_injection&alerta=cookie_injection&notificacao=cookie_injection&token=XSS"
      - "{{BaseURL}}/?instrucao=cookie_injection&comunicado=cookie_injectionerromsg=cookie_injection&sucesso=cookie_injection&btn=cookie_injection&button=cookie_injection&leight=cookie_injection&host=cookie_injection&domain=cookie_injection&http=cookie_injection&subdomain=cookie_injection&server=cookie_injection&origin=cookie_injection&ip=cookie_injection&protocol=cookie_injection&gateway=cookie_injection&site=cookie_injection&platform=cookie_injection&language=cookie_injection&encode=cookie_injection&scheme=cookie_injection&consulta=cookie_injection&submit=cookie_injection&method=cookie_injection&data-id=cookie_injection&authType=cookie_injection&isRegister=cookie_injection&loginRequestId=cookie_injection&token=XSS"      

    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)(?i)(^set-cookie.*cookie_injection.*)'
