id: cookie-injection-erickfernandox

info:
  name: Parameter based cookie injection
  author: pdteam
  severity: info
  reference:
    - https://www.invicti.com/blog/web-security/understanding-cookie-poisoning-attacks/
    - https://docs.imperva.com/bundle/on-premises-knowledgebase-reference-guide/page/cookie_injection.htm
  metadata:
    max-request: 1
  tags: reflected,dast,cookie,injection

http:
  - method: GET
    path:
      - "{{BaseURL}}/?play=cookie_injection;evil&brand_id=cookie_injection;evil&edition=cookie_injection;evil&edicao=cookie_injection;evil&fname=cookie_injection;evil&xhr=cookie_injection;evil&sort_by=cookie_injection;evil&agree=cookie_injection;evil&confirm=cookie_injection;evil&character=cookie_injection;evil&apiType=cookie_injection;evil&locale_id=cookie_injection;evil&groupID=cookie_injection;evil&group_id=cookie_injection;evil&tag_id=cookie_injection;evil"
      - "{{BaseURL}}/?dnfile=cookie_injection;evil&VideoFile=cookie_injection;evil&memb=cookie_injection;evil&sMode=cookie_injection;evil&hsLang=cookie_injection;evil&Controller=cookie_injection;evil&Model=cookie_injection;evil&View=cookie_injection;evil&updateDt=cookie_injection;evil&dest_url=cookie_injection;evil&origin_url=cookie_injection;evil&ext_url=cookie_injection;evil&tab_id=cookie_injection;evil&user_info=cookie_injection;evil&ref_id=cookie_injection;evil"     
      - "{{BaseURL}}/?hosting=cookie_injection;evil&verification=cookie_injection;evil&selected_app=cookie_injection;evil&edit=cookie_injection;evil&iDitem=cookie_injection;evil&senderName=cookie_injection;evil&senderEmail=cookie_injection;evil&formLocation=cookie_injection;evil&jobTitle=cookie_injection;evil&emailStatus=cookie_injection;evil&requestType=cookie_injection;evil&emailid=cookie_injection;evil&formType=cookie_injection;evil&emailAddress=cookie_injection;evil"
      - "{{BaseURL}}/?plataform=cookie_injection;evil&club=cookie_injection;evil&shop=cookie_injection;evil&buy=cookie_injection;evil&deal=cookie_injection;evil&cookieDomain=cookie_injection;evil&cookie_lifetime=cookie_injection;evil&lifetime=cookie_injection;evil&timeout=cookie_injection;evil&utm_source_url=cookie_injection;evil&side_bar=cookie_injection;evil&head=cookie_injection;evil&copyright=cookie_injection;evil&services=cookie_injection;evil&bounce=cookie_injection;evil&form_id=cookie_injection;evil"
      - "{{BaseURL}}/?a=cookie_injection;evil&b=cookie_injection;evil&c=cookie_injection;evil&d=cookie_injection;evil&e=cookie_injection;evil&f=cookie_injection;evil&g=cookie_injection;evil&h=cookie_injection;evil&i=cookie_injection;evil&j=cookie_injection;evil&k=cookie_injection;evil&l=cookie_injection;evil&m=cookie_injection;evil&n=cookie_injection;evil&o=cookie_injection;evil&p=cookie_injection;evil&q=cookie_injection;evil&r=cookie_injection;evil&t=cookie_injection;evil&u=cookie_injection;evil&v=cookie_injection;evil&w=cookie_injection;evil&x=cookie_injection;evil&y=cookie_injection;evil&z=cookie_injection;evil"
      - "{{BaseURL}}/?aa=cookie_injection;evil&bb=cookie_injection;evil&cc=cookie_injection;evil&dd=cookie_injection;evil&ee=cookie_injection;evil&ff=cookie_injection;evil&gg=cookie_injection;evil&hh=cookie_injection;evil&ii=cookie_injection;evil&jj=cookie_injection;evil&kk=cookie_injection;evil&ll=cookie_injection;evil&mm=cookie_injection;evil&nn=cookie_injection;evil&oo=cookie_injection;evil&pp=cookie_injection;evil&qq=cookie_injection;evil&rr=cookie_injection;evil&ss=cookie_injection;evil&tt=cookie_injection;evil&uu=cookie_injection;evil&vv=cookie_injection;evil&ww=cookie_injection;evil&xx=cookie_injection;evil&yy=cookie_injection;evil&zz=cookie_injection;evil"
      - "{{BaseURL}}/?aaa=cookie_injection;evil&bbb=cookie_injection;evil&ccc=cookie_injection;evil&ddd=cookie_injection;evil&eee=cookie_injection;evil&fff=cookie_injection;evil&ggg=cookie_injection;evil&hhh=cookie_injection;evil&iii=cookie_injection;evil&jjj=cookie_injection;evil&kkk=cookie_injection;evil&lll=cookie_injection;evil&mmm=cookie_injection;evil&nnn=cookie_injection;evil&ooo=cookie_injection;evil&ppp=cookie_injection;evil&qqq=cookie_injection;evil&rrr=cookie_injection;evil&sss=cookie_injection;evil&ttt=cookie_injection;evil&uuu=cookie_injection;evil&vvv=cookie_injection;evil&www=cookie_injection;evil&xxx=cookie_injection;evil&yyy=cookie_injection;evil&zzz=cookie_injection;evil"
      - "{{BaseURL}}/?container=cookie_injection;evil&number=cookie_injection;evil&word=cookie_injection;evil&page_no=cookie_injection;evil&aid=cookie_injection;evil&bid=cookie_injection;evil&cid=cookie_injection;evil&did=cookie_injection;evil&eid=cookie_injection;evil&fid=cookie_injection;evil&gid=cookie_injection;evil&hid=cookie_injection;evil&iid=cookie_injection;evil&jid=cookie_injection;evil&kid=cookie_injection;evil&lid=cookie_injection;evil&mid=cookie_injection;evil&nid=cookie_injection;evil&oid=cookie_injection;evil&pid=cookie_injection;evil&qid=cookie_injection;evil&rid=cookie_injection;evil&sid=cookie_injection;evil&tid=cookie_injection;evil"
      - "{{BaseURL}}/?u_id=cookie_injection;evil&vid=cookie_injection;evil&wid=cookie_injection;evil&xid=cookie_injection;evil&yid=cookie_injection;evil&zid=cookie_injection;evil&eventName=cookie_injection;evil&dt=cookie_injection;evil&ed=cookie_injection;evil&id_area=cookie_injection;evil&viewlocale=cookie_injection;evil&idnoticia=cookie_injection;evil&estilo=cookie_injection;evil&tagId=cookie_injection;evil&prd=cookie_injection;evil&paypal=cookie_injection;evil&idioma=cookie_injection;evil&editionId=cookie_injection;evil&gallery=cookie_injection;evil"
      - "{{BaseURL}}/?up=cookie_injection;evil&regiao=cookie_injection;evil&ordem=cookie_injection;evil&page_code=cookie_injection;evil&docId=cookie_injection;evil&vitrine=cookie_injection;evil&task=cookie_injection;evil&hash_identificacao=cookie_injection;evil&onload=cookie_injection;evil&filme=cookie_injection;evil&servico=cookie_injection;evil&refer=cookie_injection;evil&codNoticia=cookie_injection;evil&hashId=cookie_injection;evil&modo=cookie_injection;evil&sourcepage=cookie_injection;evil&idConteudo=cookie_injection;evil"      
      - "{{BaseURL}}/?codReuniao=cookie_injection;evil&PlayerID=cookie_injection;evil&pagewanted=cookie_injection;evil&event_time_id=cookie_injection;evil&atual=cookie_injection;evil&filtro=cookie_injection;evil&canonicalUrl=cookie_injection;evil&query_id=cookie_injection;evil&productTypeId=cookie_injection;evil&chooseCity=cookie_injection;evil&Identidade=cookie_injection;evil&init=cookie_injection;evil&gameId=cookie_injection;evil&layer=cookie_injection;evil&pro_id=cookie_injection;evil&render=cookie_injection;evil&error_on_page=cookie_injection;evil"      
      - "{{BaseURL}}/?turno=cookie_injection;evil&IdNot=cookie_injection;evil&add-to-cart=cookie_injection;evil&attachment_id=cookie_injection;evil&signo=cookie_injection;evil&sensor=cookie_injection;evil&libraries861&library=cookie_injection;evil&perPage=cookie_injection;evil&abrefoto=cookie_injection;evil&codProfile=cookie_injection;evil&linkurl=cookie_injection;evil&lookup=cookie_injection;evil&idtUrl=cookie_injection;evil&variant=cookie_injection;evil&urls=cookie_injection;evil&canal=cookie_injection;evil"
      - "{{BaseURL}}/?img_index=cookie_injection;evil&incidente=cookie_injection;evil&global=cookie_injection;evil&shade=cookie_injection;evil&time_continue=cookie_injection;evil&area=cookie_injection;evil&ref_src=cookie_injection;evil&remove_item=cookie_injection;evil&redir_esc=cookie_injection;evil&idLayer=cookie_injection;evil&is_registration=cookie_injection;evil&nodeid=cookie_injection;evil&containerId=cookie_injection;evil&paged=cookie_injection;evil&rnd=cookie_injection;evil&serviceCode=cookie_injection;evil"
      - "{{BaseURL}}/?livro_id=cookie_injection;evil&syndicationid=cookie_injection;evil&mini=cookie_injection;evil&affiliate=cookie_injection;evil&clubcode=cookie_injection;evil&plano=cookie_injection;evil&ind=cookie_injection;evil&done=cookie_injection;evil&pais=cookie_injection;evil&cidade=cookie_injection;evil&estado=cookie_injection;evil&endereco=cookie_injection;evil&cep=cookie_injection;evil&buildTime=cookie_injection;evil&start_date=cookie_injection;evil&skin=cookie_injection;evil&pcode=cookie_injection;evil&num=cookie_injection;evil"
      - "{{BaseURL}}/?codigo=cookie_injection;evil&flow=cookie_injection;evil&rbulid=cookie_injection;evil&order_type=cookie_injection;evil&anchor=cookie_injection;evil&oferta=cookie_injection;evil&bannerid=cookie_injection;evil&secao=cookie_injection;evil&sellerId=cookie_injection;evil&idArquivo=cookie_injection;evil&resultado=cookie_injection;evil&end_url=cookie_injection;evil&utm_code=cookie_injection;evil&valor=cookie_injection;evil&metodo=cookie_injection;evil&errorMessage=cookie_injection;evil&change_direction=cookie_injection;evil"

    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)(?i)(^set-cookie.*cookie_injection;evil.*)'
